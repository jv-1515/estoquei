<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Gerenciar Estoque</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #ccc;
            margin: 0;
            padding: 20px;
            font-size: 12px;
        }

        h1 {
            font-size: 40px;
            color: #0b5a66;
            text-align: center;
        }

        h2 {
            font-size: 20px;
            color: #0b5a66;
            text-align: left;
            margin: 0;
            padding-left: 5px;
        }

        .filters-container {
            max-width: 1200px;
            margin: 0 auto 24px auto;
            box-sizing: border-box;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.07);
            padding: 20px;
            display: flex;
            justify-content: center;
        }

        .filters {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            width: 100%;
            background: none;
            padding: 0;
            margin: 0;
        }

        .filters input,
        .filters select {
            padding: 7px;
            border: 1px solid #aaa;
            border-radius: 4px;
            font-size: 12px;
        }

        .btn {
            background-color: #1e94a3;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
        }

        .btn:hover {
            background-color: #094a55;
        }

        .main-container {
            background: white;
            border-radius: 10px;
            max-width: 1200px;
            margin: 0 auto;
            box-sizing: border-box;
            box-shadow: 0 2px 8px rgba(0,0,0,0.07);
        }

        table {
            width: 100%;
            background-color: white;
            border-collapse: collapse;
            border-radius: 0 0 10px 10px;
            overflow: hidden;
            font-size: 12px;
            margin: 0;
        }

        th,
        td {
            padding: 5px;
            border-bottom: 1px solid #ddd;
            text-align: center;
            vertical-align: middle;
        }

        th {

            font-weight: bold;
        }

        tr:hover {
            background-color: #f1f1f1;
        }

        .actions a, .actions button {
            background: none;
            border: none;
            color: #555;
            padding: 0;
            margin: 0 4px;
            cursor: pointer;
            font-size: 12px;
            vertical-align: middle;
            outline: none;
        }
        .actions a:hover, .actions button:hover {
            color: #1e94a3;
        }

        .produto-img {
            width: 30px;
            height: 30px;
            object-fit: cover;
            border-radius: 6px;
            background: #f3f3f3;
            display: inline-block;
            vertical-align: middle;
        }
        .produto-img.icon {
            align-items: center;
            justify-content: center;
            color: #bbb;
            font-size: 20px;
            width: 30px;
            height: 30px;
            background: #f3f3f3;
            border-radius: 6px;
            vertical-align: middle;
        }

    </style>
</head>
<body>
    <h1>Gerenciar Estoque</h1>
    <a href="javascript:history.back()" style="position: absolute; top: 20px; left: 20px; z-index: 10;">
        <button tabindex="12" style="border-radius: 50%; width: 40px; height: 40px; background-color: white; color: black; border: none; cursor: pointer; margin-top: 0;">
            <i class="fa-solid fa-arrow-left" style="font-size: 20px;"></i>
        </button>
    </a>
    <div class="filters-container">
        <div class="filters" style="flex-direction: column; align-items: stretch;">
            <h2>Filtrar produto</h2>
            <div style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
                <input type="text" id="filter-codigo" placeholder="Código" maxlength="9" style="width: 90px;" />
                <input type="text" id="filter-nome" placeholder="Nome" style="width: 160px;" />

                <select id="filter-categoria" style="width: 110px;" onchange="updateOptions()">
                    <option value="">Categoria</option>
                    <option value="CAMISA">Camisa</option>
                    <option value="CAMISETA">Camiseta</option>
                    <option value="BERMUDA">Bermuda</option>
                    <option value="CALCA">Calça</option>
                    <option value="SHORTS">Shorts</option>
                    <option value="SAPATO">Sapato</option>
                    <option value="MEIA">Meia</option>
                </select>

                <select id="filter-tamanho" style="width: 95px;">
                    <option value="">Tamanho</option>
                </select>

                <select id="filter-genero" style="width: 90px;">
                    <option value="">Gênero</option>
                    <option value="MASCULINO">Masculino</option>
                    <option value="FEMININO">Feminino</option>
                    <option value="UNISSEX">Unissex</option>
                </select>

                <input type="number" id="filter-quantidade" placeholder="Quantidade" style="width: 90px;" />
                <input type="number" id="filter-limite" placeholder="Limite Mínimo" style="width: 110px;" />
                <input type="number" id="filter-preco" placeholder="Preço (R$)" style="width: 90px;" />

                <button class="btn" onclick="filtrar()">Filtrar</button>
                <button class="btn" onclick="limpar()" style="background-color: #094a55">Limpar Filtro</button>
                <style>
                    .btn[onclick="limpar()"]:hover {
                        background-color: #062c2f !important;
                    }
                </style>
            </div>
        </div>
    </div>
        <div class="filters-container" style="align-items: center; justify-content: space-between; display: flex; margin: 0 auto 0 auto; border-radius: 10px 10px 0 0;padding: 10px 25px 10px 22px;
">
        <div style="display: flex; align-items: center; gap: 10px;">
            <label for="registros-select">Mostrando</label>
            <select id="registros-select" style="padding: 5px 4px; border-radius: 4px; border: 1px solid #aaa; font-size: 12px; width: 46px;">
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="50">50</option>
                <option value="100">100</option>
            </select>
        </div>
        <button class="btn" style="margin-left: auto;" onclick="window.location.href='/cadastrar-produto'">
            <i class="fa fa-plus" style="margin-right: 4px;"></i> Cadastrar Produto
        </button>
    </div>
    <script>
    function updateOptions() {
        const categoria = document.getElementById('filter-categoria').value;
        const tamanho = document.getElementById('filter-tamanho');
        let options = '<option value="">Tamanho</option>';

        if (categoria === 'SAPATO' || categoria === 'MEIA') {
            for (let i = 36; i <= 44; i++) {
                options += `<option value="${i}">${i}</option>`;
            }
        } else if (categoria === 'BERMUDA' || categoria === 'CALCA' || categoria === 'SHORTS') {
            for (let i = 36; i <= 52; i += 2) {
                options += `<option value="${i}">${i}</option>`;
            }
        } else if (categoria === 'CAMISA' || categoria === 'CAMISETA') {
            const tamanhos = ['Único', 'PP', 'P', 'M', 'G', 'GG', 'XG', 'XGG', 'XXG'];
            tamanhos.forEach(t => {
                options += `<option value="${t}">${t}</option>`;
            });
        } else {
            const tamanhos = ['Único', 'PP', 'P', 'M', 'G', 'GG', 'XG', 'XGG', 'XXG'];
            for (let i = 36; i <= 44; i++) {
                tamanhos.push(i.toString());
            }
            tamanhos.forEach(t => {
                options += `<option value="${t}">${t}</option>`;
            });
        }
        tamanho.innerHTML = options;
    }
        window.onload = function() {
            updateOptions();
        };
    </script>

    <div class="main-container">
        <div class="table-space"></div>
        <table id="product-list">
        </table>
    </div>

    <script>
        const produtos = [
            { codigo: "000000001", nome: "Camisa Polo", categoria: "CAMISA", tamanho: "M", genero: "MASCULINO", quantidade: 10, limite: 5, preco: "99.90", imagem: "https://images.unsplash.com/photo-1512436991641-6745cdb1723f?auto=format&fit=crop&w=100&q=80" },
            { codigo: "000000002", nome: "Camiseta Estampada", categoria: "CAMISETA", tamanho: "G", genero: "UNISSEX", quantidade: 15, limite: 7, preco: "59.90", imagem: "https://images.unsplash.com/photo-1517841905240-472988babdf9?auto=format&fit=crop&w=100&q=80" },
            { codigo: "000000003", nome: "Calça Jeans", categoria: "CALCA", tamanho: "G", genero: "FEMININO", quantidade: 8, limite: 3, preco: "129.90", imagem: "" },
            { codigo: "000000004", nome: "Sapato Social", categoria: "SAPATO", tamanho: "42", genero: "MASCULINO", quantidade: 5, limite: 2, preco: "199.90", imagem: "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=100&q=80" },
            { codigo: "000000005", nome: "Shorts Esportivo", categoria: "SHORTS", tamanho: "M", genero: "UNISSEX", quantidade: 20, limite: 10, preco: "49.90", imagem: "" }
        ];

        function renderizarProdutos(lista) {
            const container = document.getElementById("product-list");
            container.innerHTML = `
            <thead>
                <tr>
                <th>Produto</th>
                <th>Código</th>
                <th>Nome</th>
                <th>Categoria</th>
                <th>Tamanho</th>
                <th>Gênero</th>
                <th>Quantidade</th>
                <th>Limite Mínimo</th>
                <th>Preço (R$)</th>
                <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                ${lista
                .map(
                    (p, idx) => `
                <tr tabindex="${idx + 1}">
                    <td>
                    ${
                        p.imagem
                        ? `<img src="${p.imagem}" alt="Foto do produto" class="produto-img" />`
                        : `<span class="produto-img icon"><i class="fa-regular fa-image" style="padding-top:5px"></i></span>`
                    }
                    </td>
                    <td>${p.codigo}</td>
                    <td>${p.nome}</td>
                    <td>${p.categoria}</td>
                    <td>${p.tamanho}</td>
                    <td>${p.genero}</td>
                    <td>${p.quantidade}</td>
                    <td>
                        ${p.limite}
                        ${
                            p.quantidade <= (p.limite + 10)
                                ? `<a href="/reabastecer-produto/${p.codigo}" title="Reabastecer produto" style="display:inline-block;position:relative;width:20px;height:20px;text-decoration:none;">
                                    <span style="background:#000;width:5px;height:7px;position:absolute;left:50%;top:41%;transform:translate(-50%,-50%);border-radius:5px;z-index:0;"></span>
                                    <i class="fa-solid fa-triangle-exclamation" style="color:#fbc02d;position:relative;z-index:1;"></i>
                                    </a>`
                                : ''
                        }
                    </td>
                    <td>${p.preco}</td>
                    <td class="actions">
                    <a href="/editar-produto/${p.codigo}" title="Editar" tabindex="${lista.length + idx + 1}"><i class="fa-solid fa-pen"></i></a>
                    <button type="button" onclick="removerProduto('${p.codigo}')" title="Excluir" tabindex="${2 * lista.length + idx + 1}"><i class="fa-solid fa-trash"></i></button>
                    </td>
                </tr>
                `
                )
                .join("")}
            </tbody>
            `;
        }

        function filtrar() {
            const codigo = document.getElementById("filter-codigo").value;
            const nome = document.getElementById("filter-nome").value;
            const cat = document.getElementById("filter-categoria").value;
            const tam = document.getElementById("filter-tamanho").value;
            const gen = document.getElementById("filter-genero").value;
            const qtd = document.getElementById("filter-quantidade").value;
            const lim = document.getElementById("filter-limite").value;
            const preco = document.getElementById("filter-preco").value;

            const filtrados = produtos.filter(
            (p) =>
                (codigo === "" || p.codigo.includes(codigo)) &&
                (nome === "" || p.nome.toLowerCase().includes(nome.toLowerCase())) &&
                (cat === "" || p.categoria === cat) &&
                (tam === "" || p.tamanho === tam) &&
                (gen === "" || p.genero === gen) &&
                (qtd === "" || p.quantidade == qtd) &&
                (lim === "" || p.limite == lim) &&
                (preco === "" || p.preco == preco)
            );

            let msgDiv = document.getElementById("no-results-msg");
            if (!msgDiv) {
            msgDiv = document.createElement("div");
            msgDiv.id = "no-results-msg";
            msgDiv.style.textAlign = "center";
            msgDiv.style.padding = "0 0 10px 0";
            msgDiv.style.color = "#888";
            msgDiv.style.fontSize = "16px";
            document.querySelector(".main-container .table-space").appendChild(msgDiv);
            }

            if (filtrados.length === 0) {
            document.getElementById("product-list").style.display = "none";
            msgDiv.textContent = "Nenhum produto encontrado com os filtros selecionados.";
            msgDiv.style.display = "block";
            } else {
            document.getElementById("product-list").style.display = "";
            msgDiv.style.display = "none";
            renderizarProdutos(filtrados);
            }

            document.querySelector('.main-container').style.borderTopLeftRadius = "0";
            document.querySelector('.main-container').style.borderTopRightRadius = "0";
        }

        function limpar() {
            document.querySelectorAll(".filters input, .filters select").forEach((el) => (el.value = ""));
            renderizarProdutos(produtos);
        }

        function removerProduto(codigo) {
            Swal.fire({
            title: 'Tem certeza?',
            text: 'Esta ação não poderá ser desfeita.',
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#d33',
            cancelButtonColor: '#1E94A3',
            confirmButtonText: 'Remover',
            cancelButtonText: 'Cancelar'
            }).then((result) => {
            if (result.isConfirmed) {
                Swal.fire({
                title: 'Removido!',
                text: 'O produto foi removido.',
                icon: 'success',
                confirmButtonColor: '#1E94A3'
                });
            }
            });
        }

        renderizarProdutos(produtos);
    </script>
</body>
</html>